<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <!-- css -->
        <link rel="stylesheet" href="style.css" />
        <!-- <link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" > -->
        <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"/>
        <meta name="description" content="인공지능을 이용한 건강 습관 만들기">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="naver-site-verification" content="9598d0e884181219be3deac3f06c3a65a3d95562" />
        <meta property="og:url" content="https://faceshapeai.netlify.app/" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="인공지능을 이용한 건강 체크" />
        <meta property="og:description" content="인공지능이 얼굴 사진을 분석하고 그 질병의 원인이 될 수 있는 것들에 대한 정보와 개선 방법을 제공합니다." />
        <title>Health AI</title>
        <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5f02d0a9274c4624"></script>
        <!--JQuery latist-->
        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light" style="background-color: #e3f2fd;">
            <a class="navbar-brand" href="#">Health AI</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Mobile
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="#">Android</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">iOS</a>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">유용한 건강정보</a>
                </li>
              </ul>
              <iframe class="my-2 my-lg-1" src="https://coupa.ng/bFEVK2" width="10%" height="37" frameborder="0" scrolling="no"></iframe>
              <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
              </form>
            </div>
        </nav>
        <section class="section">
            <h1 class="title">인공 지능 안면 인식을 통한 건강 체크</h1>
            <h3 class="subtitle">건강은 제일의 재산이다 - 에머슨 -</h3>
        </section>
        <script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

        <div class="file-upload">
            <div class="image-upload-wrap">
                <input class="file-upload-input" type="file" onchange="readURL(this);" accept="image/*"/>
                <div class="drag-text">
                    <img src="img/photo.png" class="mt-5 pt-5 upload">
                    <h3 class="mb-5 pb-5 pt-4  upload-text">버튼을 눌러 얼굴 사진을 선택하거나 파일을 이 곳으로 끌어다 놓으세요.</h3>
                </div>
            </div>
            <div class="file-upload-content">
                <img class="file-upload-image" id="image" src="#" alt="your face image" />
                <div id="loading" class="animated bounce">
                    <span>
                        <p class="text-center">AI가 얼굴 사진을 분석하고 있습니다.</p>
                        <p class="items-center"><img src="img/emoji_25.gif" /></p>
                    </span>
                </div>
                <div class="result-message"></div>
                <br>
                <div id="label-container" class="d-flex flex-column justify-content-around"></div>
                <br>
                <div class="image-title-wrap">
                    <button type="button p-2" onclick="location.href='index.html'" class="try-again-btn">
                        <img  src="img/refresh.png">
                    </button>
                </div>
            </div>
            <br>
            <p class="tip">더 정확한 결과를 얻고 싶으시면 <b>화장하지 않은 사진</b>을 이용해 보세요!</p>
			<!— Go to www.addthis.com/dashboard to customize your tools —>
            <center><div class="addthis_inline_share_toolbox"></div></center>
        </div>
        <br>
        <i class="fas fa-exclamation-circle">본 서비스 이용 시 사진이 저장되지 않으며 의료 용도로 사용하실 수 없습니다.</i>
        <div id="coupang-banner">
            <script src="https://ads-partners.coupang.com/g.js"></script>
            <script>new PartnersCoupang.G({ id:270081 });</script>
        </div>
		<br>
		<div id="kakao-banner">
            <ins class="kakao_ad_area" style="display:none;"
                data-ad-unit    = "DAN-ubguhr7k8yt0"
                data-ad-width   = "320"
                data-ad-height  = "100"></ins>
            <script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script>
        </div>
        <br>
        <div id="disqus_thread"></div>
        <script>
            /* disqus */
            (function () {
                // DON'T EDIT BELOW THIS LINE
                var d = document,
                    s = d.createElement('script');
                s.src = 'https://healthai.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

        <script>
            function show() {
                document.querySelector('#desc').style.display = 'block';
                document.querySelector('#open').style.display = 'none';
            }
            
            function hide() {
                document.querySelector('#desc').style.display = 'none';
                document.querySelector('#open').style.display = 'block';
            }

            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('.image-upload-wrap').hide();
                        $('#loading').show();
                        $('.file-upload-image').attr('src', e.target.result);
                        $('.file-upload-content').show();
                        $('.image-title').html(input.files[0].name);
                    };

                    reader.readAsDataURL(input.files[0]);
                    init().then(() => {
                        predict();
                        $('#loading').hide();
                    });
                } else {
                    removeUpload();
                }
            }

            function removeUpload() {
                $('.file-upload-input').replaceWith($('.file-upload-input').clone());
                $('.file-upload-content').hide();
                $('.image-upload-wrap').show();
            }
            $('.image-upload-wrap').bind('dragover', function () {
                $('.image-upload-wrap').addClass('image-dropping');
            });
            $('.image-upload-wrap').bind('dragleave', function () {
                $('.image-upload-wrap').removeClass('image-dropping');
            });
        </script>

        <script type="text/javascript">
            // More API functions here:
            // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

            // the link to your model provided by Teachable Machine export panel
			const URL = 'https://teachablemachine.withgoogle.com/models/CDNm7zYL_/';

            let model, labelContainer, maxPredictions;

            // Load the image model
            async function init() {
                const modelURL = URL + 'model.json';
                const metadataURL = URL + 'metadata.json';

                // load the model and metadata
                // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
                // or files from your local hard drive
                // Note: the pose library adds "tmImage" object to your window (window.tmImage)
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = 4;

                // append elements to the DOM
                labelContainer = document.getElementById('label-container');
                for (let i = 0; i < maxPredictions; i++) {
                    // and class labels
                    labelContainer.appendChild(document.createElement('div'));
                }
            }

            // run the image through the image model
            async function predict() {
                // predict can take in an image, video or canvas html element
                var image = document.getElementById('image');
                const prediction = await model.predict(image, false);
                prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));

                var result, explain, advice;

                switch (prediction[0].className) {
                    case 'healthy':
                        result = '건강한 상태';
                        explain = "<br>건강 상태를 유지하기 위하여 규칙적인 습관과 운동을 잊지 마세요~!";
                        advice = "<br>건강은 건강 할 때 지켜야 합니다. 주기적인 건강검진을 잊지 마세요.";
                        break;
                    case 'black':
                        result= '검정빛';
                        explain = "<br>주의해야 할 질병 : 말초혈액순환 장애, 신장질환";
                        advice = "<br>신장 질환을 예방하기 위해 검은콩, 옥수수수염차, 산약차, 산수유, 복분자가 도움이 되며 옥수수수염, 당귀, 음양곽은 얼굴이 붓는 것을 막아줍니다. <br> 햇빛에 그을렸을 수도 있으니 장시간 외출 시에 자외선 차단 크림을 사용해 보세요.";
                        break;
                    case 'yellow':
                        result = '누런끼';
                        explain = "<br>간이나 담낭(쓸개)에 문제가 생기면 혈액 내 빌리루빈의 수치가 증가하며 안색을 노랗게(황달) 만듭니다. 또한 위나 십이지장 등의 소화기관에 관계가 있습니다.<br>주의해야 할 질병들 : 빈혈, 간질환, 간암, 담석, 담낭염, 담낭암, 췌장염, 췌장암";
                        advice = "<br>음주나 수면 부족이 간 기능과 연관이 있습니다. 황달은 담즙 색소가 원활하게 배출되지 않아 혈액으로 흡수되며 생깁니다. 손, 발, 눈 흰자위가 노랗게 변하게 되다면 병원에서 관련 검사를 통한 전문의의 진료가 필요합니다.<br> 위장 건강을 위해 규칙적인 식사를 하시고 황기차, 인삼차, 백출차, 산사차를 자주 마시는 것이 도움이 됩니다.";
                        break;
                    case 'red':
                        result = '안면홍조';
                        explain = "<br>혈액 순환이 원활하지 않을 경우 체내 세포와 조직에 피와 산소가 충분히 공급되지 않아서 혈관이 확장되고 이로 인하여 얼굴이 불그스름 해 질 수 있습니다. <br>주의해야 할 질병들:협심증, 심근경색";
                        advice = "<br>열이 많은 체질 일 수도 있습니다. 체증 증가에 신경쓰시고 스트레칭을 통한 어깨결림, 두통 등과 같은 증상을 예방하며 혈액 순환을 개선할 수 있습니다.";
                        break;
                    case 'pale':
                        result= '창백함';
                        explain = "<br>얼굴에 핏기가 없을 때 창백해 질 수 있습니다. 빈혈, 폐렴, 만성 기관지염, 폐암과 같은 호흡기 기능이 좋지 않을 때 나타날 수 있습니다.";
                        advice = "<br>삼림욕을 통해 맑은 공기를 자주 마시는 것을 추천해 드립니다. 폐를 튼튼하게 하기 위한 오미자, 도라지, 살구씨 섭취를 통해 몸을 따뜻하게 해 주시면 도움이 됩니다. <br> 참고로 내장 출혈이 있는 경우에도 빈혈로 안면이 창백해 질 수 있으며 대변은 검은색이 됩니다.";
                        break;
                    case 'freckles':
                        result = '기미와 주근깨';
                        explain = "<br>노폐물을 해독하는 간 기능이나 자외선으로 인한 활성 산소를 제거하는 능력이 저하 되는 것과 관련이 있습니다.<br>";
                        advice = "<br>외출 시 햇빛에 노출 되는 시간을 고려하여 자외선 차단 크림을 사용하세요.<br>";
                        break;
                    case 'darkcircle':
                        result = '다크써클';
                        explain = "<br>과로나 스트레스에 의한 영향으로<b>휴식</b>과 충분한 영향분 섭취가 필요합니다! 혹은 혈액순환과 관련이 있을 수 있습니다. <br> 주의해야 할 질병 : 신장병<br>";
                        advice = "<br>눈가에 온찜질, 메이크업 꼼꼼히 지우기, 화장 또는 세안 시 눈가에 자극 주지 않기 등을 통하여 개선 할 수 있습니다.<br>";
                        break;
                    case 'default':
                        result = '잘못된결과';
                        explain = "에러가 발생했습니다. 나중에 다시 시도하여 주세요!";
                        advice = "나중에 다시 시도하세요!";
                        break;
                }
                var title = "<div class='" + prediction[0].className + "_title'>" + result + "</div>"
                var explain = "<div class='explain pt-2'>" + explain + "</div>"
                var advice = "<div class='advice'>" + advice + "</div>"

                $('.result-message').html(title + explain + advice);

                var barWidth;
                for (let i = 0; i < maxPredictions; i++) {
                    if (prediction[i].probability.toFixed(2) == 0) {
                        continue;
                        
                    } else {
                        barWidth = Math.round(prediction[i].probability.toFixed(2) * 100) + "%";
                    }

                    var labelTitle;

                    switch (prediction[i].className) {
                        case "healthy":
                            labelTitle = "건강"
                            break;
                        case "black":
                            labelTitle = "검정빛깔"
                            break;
                        case "yellow":
                            labelTitle = "누런끼"
                            break;
                        case "red":
                            labelTitle = "홍조"
                            break;
                        case "pale":
                            labelTitle = "창백함"
                            break;
                        case "freckles":
                            labelTitle = "기미와 주근깨"
                            break;
                        case "darkcircle":
                            labelTitle = "다크서클"
                            break;
                        default:
                            labelTitle = "알 수 없음"
                }

                var label = "<div class='healthy-label d-flex align-items-center'>" + labelTitle + "</div>"
                var bar = "<div class='bar-container position-relative container'><div class='" + prediction[i].className + "-box'></div><div class='d-flex justify-content-center align-items-center " + prediction[i].className + "-bar' style='width: " + barWidth + "'><span class='d-block percent-text'>" + Math.round(prediction[i].probability.toFixed(2) * 100) + "%</span></div></div>"
                labelContainer.childNodes[i].innerHTML = label + bar;
            }
        }
        </script>
        <footer>
        <div class="border-b" style="margin-bottom: 3vh;">
            <div class="flex flex-col justify-center items-center">
                <span class="text-gray-600 last-text">© Health AI 2020. All Rights Reserved.</span>
            </div>
        </div>
        </footer>
    </body>
</html>
<!--
파트너스 활동을 통해 일정액의 수수료를 제공받을 수 있음
-->
<!--Copyright (c) 2020 by Aaron Vanston (https://codepen.io/aaronvanston/pen/yNYOXR)
Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-->